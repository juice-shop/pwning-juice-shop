= Sensitive Data Exposure

include::../attributes.adoc[]

[discrete]
== Challenges covered in this chapter

|===
| Name | Description | Difficulty

| Confidential Document
| Access a confidential document.
| ⭐

| Email Leak
| Perform an unwanted information disclosure by accessing data cross-domain.
| ⭐⭐⭐⭐⭐

| Exposed Credentials
| A developer was careless with hardcoding unused, but still valid credentials for a testing account on the client-side.
| ⭐⭐

| Forgotten Developer Backup
| Access a developer's forgotten backup file.
| ⭐⭐⭐⭐

| Forgotten Sales Backup
| Access a salesman's forgotten backup file.
| ⭐⭐⭐⭐

| GDPR Data Theft
| Steal someone else's personal data without using Injection.
| ⭐⭐⭐⭐

| Leaked API Key
| Inform the shop about a leaked API key. (Mention the exact key in your comment)
| ⭐⭐⭐⭐⭐

| Leaked Unsafe Product
| Identify an unsafe product that was removed from the shop and inform the shop which ingredients are dangerous.
| ⭐⭐⭐⭐

| Login Amy
| Log in with Amy's original user credentials. (This could take 93.83 billion trillion trillion centuries to brute force, but luckily she did not read the "One Important Final Note")
| ⭐⭐⭐

| Login MC SafeSearch
| Log in with MC SafeSearch's original user credentials without applying SQL Injection or any other bypass.
| ⭐⭐

| Meta Geo Stalking
| Determine the answer to John's security question by looking at an upload of him to the Photo Wall and use it to reset his password via the Forgot Password mechanism.
| ⭐⭐

| NFT Takeover
| Take over the wallet containing our official Soul Bound Token (NFT).
| ⭐⭐

| Reset Uvogin's Password
| Reset Uvogin's password via the Forgot Password mechanism with _his original answer_ to his security question.
| ⭐⭐⭐⭐

| Retrieve Blueprint
| Deprive the shop of earnings by downloading the blueprint for one of its products.
| ⭐⭐⭐⭐⭐

| Visual Geo Stalking
| Determine the answer to Emma's security question by looking at an upload of her to the Photo Wall and use it to reset her password via the Forgot Password mechanism.
| ⭐⭐⭐⭐
|===

== Access a confidential document

Somewhere in the application you can find a file that contains sensitive
information about some - potentially hostile - takeovers the Juice Shop
top management has planned.

include::../../partials/hints/directoryListingChallenge.adoc[]

== Perform an unwanted information disclosure by accessing data cross-domain

Somewhere in the application there is an API endpoint which will allow
data to be accessed cross domain. Usually the same-origin policy would
prevent this but this endpoint has a special feature enabled which will
allow cross domain access under certain circumstances.

include::../../partials/hints/emailLeakChallenge.adoc[]

== A developer was careless with hardcoding unused but still valid credentials

include::../../partials/hints/exposedCredentialsChallenge.adoc[]

== Access a developer's forgotten backup file

During an emergency incident and the hotfix that followed, a developer
accidentally pasted an application configuration file into the wrong
place. Downloading this file will not only solve the _Access a
developer's forgotten backup file_ challenge but might also prove
crucial in several other challenges later on.

include::../../partials/hints/forgottenDevBackupChallenge.adoc[]

== Access a salesman's forgotten backup file

A salesperson as accidentally uploaded a list of (by now outdated)
coupon codes to the application. Downloading this file will not only
solve the _Access a salesman's forgotten backup file_ challenge but
might also prove useful in another challenge later on.

include::../../partials/hints/forgottenBackupChallenge.adoc[]

== Steal someone else's personal data without using Injection

In order to comply with GDPR, the Juice Shop offers a _Request Data
Export_ function for its registered customers. It is possible to exploit
a flaw in the feature to retrieve more data than intended. Injection
attacks will not count to solve this one.

include::../../partials/hints/dataExportChallenge.adoc[]

== Inform the shop about a leaked API key

____
Public REST services without access control run the risk of being farmed leading to excessive bills for bandwidth or compute cycles. API keys can be used to mitigate this risk. They are also often used by organisation to monetize APIs; instead of blocking high-frequency calls, clients are given access in accordance to a purchased access plan.

API keys can reduce the impact of denial-of-service attacks. However, when they are issued to third-party clients, they are relatively easy to compromise.footnote:3_10_8[https://cheatsheetseries.owasp.org/cheatsheets/REST_Security_Cheat_Sheet.html#api-keys]
____

include::../../partials/hints/leakedApiKeyChallenge.adoc[]


== Identify an unsafe product that was removed from the shop and inform the shop which ingredients are dangerous

Similar to
xref:part2/observability-failures.adoc#_dumpster_dive_the_internet_for_a_leaked_password_and_log_in_to_the_original_user_account_it_belongs_to[Dumpster dive the Internet for a leaked password and log in to the original user account it belongs to]
this challenge further highlights the risks from a lack of data loss
prevention.

include::../../partials/hints/dlpPastebinDataLeakChallenge.adoc[]

== Log in with Amy's original user credentials

This challenge is similar to
xref:part2/broken-authentication.adoc#_log_in_with_the_administrators_user_credentials_without_previously_changing_them_or_applying_sql_injection[Log in with the administrators user credentials without previously changing them or applying SQL Injection]
in the sense that only using her original credentials will work as a
challenge solutions.

image::part2/amy_and_kif.jpg[Amy and Kif Kroker]

include::../../partials/hints/loginAmyChallenge.adoc[]

== Log in with MC SafeSearch's original user credentials

Another user login challenge where only the original password is
accepted as a solution. Employing SQL Injection or other attacks does
not count.

include::../../partials/hints/loginRapperChallenge.adoc[]
+
image::part2/protect-ya-passwordz.jpg["Protect Ya Passwordz",link=https://www.youtube.com/watch?v=v59CX2DiX0Y]

== Determine the answer to John's security question

Who would have guessed that a simple walk in the park could lead to an
account compromise. People these days are not careful with what they
post online and are not aware of the possible consequences it can have
when people exploit that.

include::../../partials/hints/geoStalkingMetaChallenge.adoc[]

== Take over the wallet containing our official Soul Bound Token

include::../../partials/hints/nftUnlockChallenge.adoc[]

== Reset Uvogin's password via the Forgot Password mechanism

With the amount of personal information that people tend to reveal
online, security questions are hardly reliable anymore.

include::../../partials/hints/resetPasswordUvoginChallenge.adoc[]

== Deprive the shop of earnings by downloading the blueprint for one of its products

Why waste money for a product when you can just as well get your hands
on its blueprint in order to make it yourself?

include::../../partials/hints/retrieveBlueprintChallenge.adoc[]

ℹ️ _If you are running the Juice Shop with a custom theme and product
inventory, the product to inspect will be a different one. The tooltip
on the Score Board will tell you which one to look into._

== Determine the answer to Emma's security question

It is also possible to determine where a picture was taken by looking at
visual clues within the image. A certain user has uploaded a picture of
his old workplace. Take a look at what his security question is and see
if you can find the answer by looking at his uploaded image.

include::../../partials/hints/geoStalkingVisualChallenge.adoc[]
