= Broken Authentication[[_broken_authentication]]

include::../attributes.adoc[]

[discrete]
== Challenges covered in this chapter

|===
| Name | Description | Difficulty

| Bjoern's Favorite Pet
| Reset the password of Bjoern's OWASP account via the Forgot Password mechanism with _the truthful answer_ to his security question.
| ⭐⭐⭐

| Change Bender's Password
| Change Bender's password into _slurmCl4ssic_ without using SQL Injection or Forgot Password.
| ⭐⭐⭐⭐

| GDPR Data Erasure
| Log in with Chris' erased user account.
| ⭐⭐⭐

| Login Bjoern
| Log in with Bjoern's Gmail account without previously changing his password, applying SQL Injection, or hacking his Google account.
| ⭐⭐⭐⭐

| Password Strength
| Log in with the administrator's user credentials without previously changing them or applying SQL Injection.
| ⭐⭐

| Reset Bender's Password
| Reset Bender's password via the Forgot Password mechanism with _the truthful answer_ to his security question.
| ⭐⭐⭐⭐

| Reset Bjoern's Password
| Reset the password of Bjoern's internal account via the Forgot Password mechanism with _the truthful answer_ to his security question.
| ⭐⭐⭐⭐⭐

| Reset Jim's Password
| Reset Jim's password via the Forgot Password mechanism with _the truthful answer_ to his security question.
| ⭐⭐⭐

| Two Factor Authentication
| Solve the 2FA challenge for user "wurstbrot". (Disabling, bypassing or overwriting his 2FA settings does not count as a solution)
| ⭐⭐⭐⭐⭐
|===

== Reset the password of Bjoern's OWASP account via the Forgot Password mechanism

This challenge is not about any technical vulnerability. Instead it is
about finding out the answer to user Bjoern's chosen security question
and use it to reset the password of his OWASP account.

____
Many website registrations use security questions for both password
retrieval/reset and sign-in verification. Some also ask the same
security questions when users call on the phone. Security questions
are one method to verify the user and stop unauthorized access. But
there are problems with security questions. Websites may use poor
security questions that may have negative results:

The user can't accurately remember the answer or the answer changed,
The question doesn't work for the user, The question is not safe and
could be discovered or guessed by others. It is essential that we use
good questions. Good security questions meet five criteria. The answer
to a good security question is:

* *Safe*: cannot be guessed or researched
* *Stable*: does not change over time
* *Memorable*: can remember
* *Simple*: is precise, easy, consistent
* *Many*: has many possible answers

It is difficult to find questions that meet all five criteria which
means that some questions are good, some fair, and most are poor. *In
reality, there are few if any GOOD security questions.* People share
so much personal information on social media, blogs, and websites,
that it is hard to find questions that meet the criteria above. In
addition, many questions are not applicable to some people; for
example, what is your oldest child's nickname -- but you don't have a
child.footnote:3_3_1[http://goodsecurityquestions.com]
____

include::../../partials/hints/resetPasswordBjoernOwaspChallenge.adoc[]

____
Doxing (from dox, abbreviation of documents) or doxxing is the
Internet-based practice of researching and broadcasting private or
identifiable information (especially personally identifiable
information) about an individual or organization.

The methods employed to acquire this information include searching
publicly available databases and social media websites (like
Facebook), hacking, and social engineering. It is closely related to
Internet vigilantism and hacktivism.

Doxing may be carried out for various reasons, including to aid law
enforcement, business analysis, risk analytics, extortion, coercion,
inflicting harm, harassment, online shaming, and vigilante
justice.footnote:3_3_2[https://en.wikipedia.org/wiki/Doxing]
____

== Change Bender's password into slurmCl4ssic without using SQL Injection or Forgot Password

This challenge can only be solved by changing the password of user
Bender into _slurmCl4ssic_. Using any sort of SQL Injection will _not_
solve the challenge, even if the password is successfully changed in the
process. Beating Bender's security question to change his password also
does not suffice to solve this challenge!

include::../../partials/hints/changePasswordBenderChallenge.adoc[]

____
A rainbow table is a precomputed table for reversing cryptographic
hash functions, usually for cracking password hashes. Tables are
usually used in recovering a plaintext password up to a certain length
consisting of a limited set of characters. It is a practical example
of a space/time trade-off, using less computer processing time and
more storage than a brute-force attack which calculates a hash on
every attempt, but more processing time and less storage than a simple
lookup table with one entry per hash. Use of a key derivation function
that employs a salt makes this attack infeasible.footnote:3_3_3[https://en.wikipedia.org/wiki/Rainbow_table]
____

== Log in with Chris' erased user account

This challenge is about loggin in with the account of a user who
previously insisted on his "right to be forgotten" in accordance with
Art. 17 GDPR.

include::../../partials/hints/ghostLoginChallenge.adoc[]

== Log in with Bjoern's Gmail account

The author of the OWASP Juice Shop (and of this book) was bold enough to
link his Google account to the application. His account even ended up in
the initial user records that are shipped with the Juice Shop for your
hacking pleasure!

If you do not see the _Log in with Google_ button, do not despair! The
hostname your Juice Shop is running on is simply not configured in the
OAuth integration with Google. The OAuth-related challenges are still
solvable! It might just take a little bit more detective work to find
out how an OAuth login is handled.

You can always use the official demo instance at
http://demo.owasp-juice.shop to play with Google login and learn how
it works there, then apply what you learned on your local instance.

include::../../partials/hints/oauthUserPasswordChallenge.adoc[]

The unremarkable side note _*without* hacking his Google account_ in
the challenge description is _not a joke_. Please do not try to break
into Bjoern's (or anyone else's) Google account. This would be a
criminal act.

== Log in with the administrator's user credentials without previously changing them or applying SQL Injection

You might have already solved this challenge along with
xref:part2/injection.adoc#_log_in_with_the_administrators_user_account[Log in with the administrator's user account]
if you chose not to use SQL Injection. This challenge can only be solved
if you use the original password of the administrator. If you changed
the password previously, do not despair: The original password will
__always__ be accepted to make sure you can solve this challenge.

include::../../partials/hints/weakPasswordChallenge.adoc[]

== Reset Bender's password via the Forgot Password mechanism

This challenge is about finding the answer to user Bender's security
question. It is probably slightly harder to find out than Jim's answer.

include::../../partials/hints/resetPasswordBenderChallenge.adoc[]

== Reset the password of Bjoern's internal account via the Forgot Password mechanism

This challenge is about finding the answer to the security question of
Bjoern's internal user account `bjoern@juice-sh.op`.

include::../../partials/hints/resetPasswordBjoernChallenge.adoc[]

== Reset Jim's password via the Forgot Password mechanism

This challenge is about finding the answer to user Jim's security
question.

include::../../partials/hints/resetPasswordJimChallenge.adoc[]

== Solve the 2FA challenge for user "wurstbrot"

____
*Multi-factor authentication (MFA)* is an authentication method in
which a computer user is granted access only after successfully
presenting two or more pieces of evidence (or factors) to an
authentication mechanism: knowledge (something the user and only the
user knows), possession (something the user and only the user has),
and inherence (something the user and only the user is).

*Two-factor authentication* (also known as *2FA*) is a type, or
subset, of multi-factor authentication. It is a method of confirming
users' claimed identities by using a combination of two different
factors: 1) something they know, 2) something they have, or 3)
something they are.

A good example of two-factor authentication is the withdrawing of
money from an ATM; only the correct combination of a bank card
(something the user possesses) and a PIN (something the user knows)
allows the transaction to be carried out.

Two other examples are to supplement a user-controlled password with a
one-time password (OTP) or code generated or received by an
authenticator (e.g. a security token or smartphone) that only the user
possesses.footnote:3_3_4[https://en.wikipedia.org/wiki/Multi-factor_authentication]
____

In the Juice Shop one customer was very security-aware and set up 2FA
for his account. He goes by the hilarious username _wurstbrot_.footnote:3_3_5[https://www.dict.cc/?s=wurstbrot]

include::../../partials/hints/twoFactorAuthUnsafeSecretStorageChallenge.adoc[]
