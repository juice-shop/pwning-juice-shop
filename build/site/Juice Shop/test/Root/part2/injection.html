<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Injection :: Juice Shop Docs</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Juice Shop Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="Juice Shop" data-version="test">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Juice shop Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Preface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/readme.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/motivation.html">Why OWASP Juice Shop exists</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/architecture.html">Architecture overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part I - Hacking preparations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/README.html">Hacking preparations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/running.html">Running OWASP Juice Shop</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/categories.html">Vulnerability categories</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/challenges.html">Challenge tracking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/rules.html">Hacking exercise rules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/happy-path.html">Walking the "happy path"</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/customization.html">Customization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/ctf.html">Hosting a CTF event</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part II - Challenge hunting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="README.html">Challenge hunting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="score-board.html">Finding the Score Board</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="injection.html">Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-authentication.html">Broken Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sensitive-data-exposure.html">Sensitive Data Exposure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xxe.html">XML External Entities (XXE)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="improper-input-validation.html">Improper Input Validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-access-control.html">Broken Access Control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security-misconfiguration.html">Security Misconfiguration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xss.html">Cross Site Scripting (XSS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="insecure-deserialization.html">Insecure Deserialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vulnerable-components.html">Vulnerable Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security-through-obscurity.html">Security through Obscurity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="unvalidated-redirects.html">Unvalidated Redirects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-anti-automation.html">Broken Anti-Automation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cryptographic-issues.html">Cryptographic Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="miscellaneous.html">Miscellaneous</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part III - Getting involved</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/README.html">Getting involved</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/feedback.html">Provide feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/contribution.html">Contribute to development</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/codebase.html">Codebase 101</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/translation.html">Help with translation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/tutorials.html">Hacking Instructor tutorial scripts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/donations.html">Donations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Appendix</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/solutions.html">Challenge solutions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/trainers.html">Trainer&#8217;s guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/cheat-detection.html">Cheat detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/code-snippets.html">Coding challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/integration.html">Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/chatbot.html">Chatbot training data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/lyrics.html">Jingle lyrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Postface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/about.html">About this book</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Juice shop Documentation</span>
    <span class="version">test</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Juice shop Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">test</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Juice shop Documentation</a></li>
    <li>Part II - Challenge hunting</li>
    <li><a href="injection.html">Injection</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///Users/parthnanda/Desktop/Gsoc/pwning-juice-shop/modules/Root/pages/part2/injection.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Injection</h1>
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Injection flaws allow attackers to relay malicious code through an
application to another system. These attacks include calls to the
operating system via system calls, the use of external programs via
shell commands, as well as calls to backend databases via SQL (i.e.,
SQL injection). Whole scripts written in Perl, Python, and other
languages can be injected into poorly designed applications and
executed. Any time an application uses an interpreter of any type
there is a danger of introducing an injection vulnerability.</p>
</div>
<div class="paragraph">
<p>Many web applications use operating system features and external
programs to perform their functions. Sendmail is probably the most
frequently invoked external program, but many other programs are used
as well. When a web application passes information from an HTTP
request through as part of an external request, it must be carefully
scrubbed. Otherwise, the attacker can inject special (meta)
characters, malicious commands, or command modifiers into the
information and the web application will blindly pass these on to the
external system for execution.</p>
</div>
<div class="paragraph">
<p>SQL injection is a particularly widespread and dangerous form of
injection. To exploit a SQL injection flaw, the attacker must find a
parameter that the web application passes through to a database. By
carefully embedding malicious SQL commands into the content of the
parameter, the attacker can trick the web application into forwarding
a malicious query to the database. These attacks are not difficult to
attempt and more tools are emerging that scan for these flaws. The
consequences are particularly damaging, as an attacker can obtain,
corrupt, or destroy database contents.</p>
</div>
<div class="paragraph">
<p>Injection vulnerabilities can be very easy to discover and exploit,
but they can also be extremely obscure. The consequences of a
successful injection attack can also run the entire range of severity,
from trivial to complete system compromise or destruction. In any
case, the use of external calls is quite widespread, so the likelihood
of an application having an injection flaw should be considered
high.<sup class="footnote" id="_footnote_1">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_challenges_covered_in_this_chapter"><a class="anchor" href="#_challenges_covered_in_this_chapter"></a>Challenges covered in this chapter</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Difficulty</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Christmas Special</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Order the Christmas special offer of 2014.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database Schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exfiltrate the entire DB schema definition via SQL Injection.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ephemeral Accountant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log in with the (non-existing) accountant <em>acc0unt4nt@juice-sh.op</em> without ever registering that user.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login Admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log in with the administrator&#8217;s user account.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login Bender</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log in with Bender&#8217;s user account.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Login Jim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log in with Jim&#8217;s user account.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NoSQL DoS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Let the server sleep for some time. (It has done more than enough hard work for you)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NoSQL Exfiltration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All your orders are belong to us! Even the ones which don&#8217;t!</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NoSQL Manipulation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update multiple product reviews at the same time.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSTi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Infect the server with juicy malware by abusing arbitrary command execution.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Credentials</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve a list of all user credentials via SQL Injection.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>ℹ️ <em>Please note that some NoSQL Injection challenges described below
are <strong>not available</strong> when running the Juice Shop in either a Docker
container or on a Heroku dyno! The used query syntax allows any
sufficiently skilled attacker to execute arbitrary code including to
terminate the application process.</em></p>
</div>
<h4 id="_reconnaissance_advice" class="discrete">Reconnaissance advice</h4>
<div class="paragraph">
<p>Instead of trying random attacks or go through an attack pattern list,
it is a good idea to find out if and where a vulnerability exists,
first. By injecting a payload that should typically <em>break</em> an
underlying SQL query (e.g. <code>'</code> or <code>';</code>) you can analyze how the
behaviour differs from regular use. Maybe you can even provoke an error
where the application leaks details about the query structure and schema
details like table or column names. Do not miss this opportunity.</p>
</div>
<div class="sect2">
<h3 id="_order_the_christmas_special_offer_of_2014"><a class="anchor" href="#_order_the_christmas_special_offer_of_2014"></a>Order the Christmas special offer of 2014</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Blind SQL (Structured Query Language) injection is a type of SQL
Injection attack that asks the database true or false questions and
determines the answer based on the applications response. This attack
is often used when the web application is configured to show generic
error messages, but has not mitigated the code that is vulnerable to
SQL injection.</p>
</div>
<div class="paragraph">
<p>When an attacker exploits SQL injection, sometimes the web application
displays error messages from the database complaining that the SQL
Query&#8217;s syntax is incorrect. Blind SQL injection is nearly identical
to normal SQL Injection, the only difference being the way the data is
retrieved from the database. When the database does not output data to
the web page, an attacker is forced to steal data by asking the
database a series of true or false questions. This makes exploiting
the SQL Injection vulnerability more difficult, but not
impossible.<sup class="footnote" id="_footnote_4">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>To solve this challenge you need <em>to order</em> a product that is not
supposed to be available any more.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Find out how the application <em>hides</em> deleted products from its
customers.</p>
</li>
<li>
<p>Try to craft an attack string that makes deleted products visible
again.</p>
</li>
<li>
<p>You need to get the deleted product into your shopping cart and
trigger the <em>Checkout</em>.</p>
</li>
<li>
<p>Neither of the above can be achieved through the application frontend
and it might even require (half-)Blind SQL Injection.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_exfiltrate_the_entire_db_schema_definition_via_sql_injection"><a class="anchor" href="#_exfiltrate_the_entire_db_schema_definition_via_sql_injection"></a>Exfiltrate the entire DB schema definition via SQL Injection</h3>
<div class="paragraph">
<p>An attacker would try to exploit SQL Injection to find out as much as
possible about your database schema. This subsequently allows much more
targeted, stealthy and devastating SQL Injections, like
<a href="#retrieve-a-list-of-all-user-credentials-via-sql-injection">Retrieve a list of all user credentials via SQL Injection</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Find out which database system is in use and where it would usually
store its schema definitions.</p>
</li>
<li>
<p>Craft a <code>UNION SELECT</code> attack string to join the relevant data from
any such identified system table into the original result.</p>
</li>
<li>
<p>You might have to tackle some query syntax issues step-by-step,
basically hopping from one error to the next</p>
</li>
<li>
<p>As with
<a href="#order-the-christmas-special-offer-of-2014">Order the Christmas special offer of 2014</a>
this cannot be achieved through the application frontend.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_log_in_with_the_non_existing_accountant_without_ever_registering_that_user"><a class="anchor" href="#_log_in_with_the_non_existing_accountant_without_ever_registering_that_user"></a>Log in with the (non-existing) accountant without ever registering that user</h3>
<div class="paragraph">
<p>In ths challenge you need to log in with a user that has
accountant-level permissions, but does not really exist.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The user literally needs to be <em>ephemeral</em> as in
<a href="https://dictionary.cambridge.org/de/worterbuch/englisch/ephemeral">"lasting for only a short time"</a>.</p>
</li>
<li>
<p>Registering normally with the user&#8217;s email address will then obviously
not solve this challenge. The Juice Shop will not even let you
register as <code>acc0unt4nt@juice-sh.op</code>, as this would make the challenge
unsolvable for you.</p>
</li>
<li>
<p>Getting the user into the database some other way will also fail to
solve this challenge. In case you somehow managed to do so, you need
to restart the Juice Shop application in order to wipe the database
and make the challenge solvable again.</p>
</li>
<li>
<p>The fact that this challenge is in the <em>Injection</em> category should
already give away the intended approach.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/part2/nice_try-error.png" alt="Nice try error when registering ephemeral accountant user">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_log_in_with_the_administrators_user_account"><a class="anchor" href="#_log_in_with_the_administrators_user_account"></a>Log in with the administrator&#8217;s user account</h3>
<div class="paragraph">
<p>What would a vulnerable web application be without an administrator user
account whose (supposedly) privileged access rights a successful hacker
can abuse?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The challenge description probably gave away what form you should
attack.</p>
</li>
<li>
<p>If you happen to know the email address of the admin already, you can
launch a targeted attack.</p>
</li>
<li>
<p>You might be lucky with a dedicated attack pattern even if you have no
clue about the admin email address.</p>
</li>
<li>
<p>If you harvested the admin&#8217;s password hash, you can of course try to
attack that instead of using SQL Injection.</p>
</li>
<li>
<p>Alternatively you can solve this challenge as a <em>combo</em> with the
<a href="broken-authentication.adoc#log-in-with-the-administrators-user-credentials-without-previously-changing-them-or-applying-sql-injection">Log in with the administrator&#8217;s user credentials without previously changing them or applying SQL Injection</a>
challenge.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_log_in_with_benders_user_account"><a class="anchor" href="#_log_in_with_benders_user_account"></a>Log in with Bender&#8217;s user account</h3>
<div class="paragraph">
<p>Bender is a regular customer, but mostly hangs out in the Juice Shop to
troll it for its lack of alcoholic beverages.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The challenge description probably gave away what form you should
attack.</p>
</li>
<li>
<p>You need to know (or smart-guess) Bender&#8217;s email address so you can
launch a targeted attack.</p>
</li>
<li>
<p>In case you try some other approach than SQL Injection, you will
notice that Bender&#8217;s password hash is not very useful.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_log_in_with_jims_user_account"><a class="anchor" href="#_log_in_with_jims_user_account"></a>Log in with Jim&#8217;s user account</h3>
<div class="paragraph">
<p>Jim is a regular customer. He prefers juice from fruits that no man has
ever tasted before.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The challenge description probably gave away what form you should
attack.</p>
</li>
<li>
<p>You need to know (or smart-guess) Jim&#8217;s email address so you can
launch a targeted attack.</p>
</li>
<li>
<p>If you harvested Jim&#8217;s password hash, you can try to attack that
instead of using SQL Injection.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_let_the_server_sleep_for_some_time"><a class="anchor" href="#_let_the_server_sleep_for_some_time"></a>Let the server sleep for some time</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>NoSQL databases provide looser consistency restrictions than
traditional SQL databases. By requiring fewer relational constraints
and consistency checks, NoSQL databases often offer performance and
scaling benefits. Yet these databases are still potentially vulnerable
to injection attacks, even if they aren&#8217;t using the traditional SQL
syntax. Because these NoSQL injection attacks may execute within a
procedural language, rather than in the declarative SQL language, the
potential impacts are greater than traditional SQL injection.</p>
</div>
<div class="paragraph">
<p>NoSQL database calls are written in the application&#8217;s programming
language, a custom API call, or formatted according to a common
convention (such as XML, JSON, LINQ, etc). Malicious input targeting
those specifications may not trigger the primarily application
sanitization checks. For example, filtering out common HTML special
characters such as <code>&lt; &gt; &amp; ;</code> will not prevent attacks against a JSON
API, where special characters include `/ { } : `.</p>
</div>
<div class="paragraph">
<p>There are now over 150 NoSQL databases available for use within an
application, providing APIs in a variety of languages and relationship
models. Each offers different features and restrictions. Because there
is not a common language between them, example injection code will not
apply across all NoSQL databases. For this reason, anyone testing for
NoSQL injection attacks will need to familiarize themselves with the
syntax, data model, and underlying programming language in order to
craft specific tests.</p>
</div>
<div class="paragraph">
<p>NoSQL injection attacks may execute in different areas of an
application than traditional SQL injection. Where SQL injection would
execute within the database engine, NoSQL variants may execute during
within the application layer or the database layer, depending on the
NoSQL API used and data model. Typically NoSQL injection attacks will
execute where the attack string is parsed, evaluated, or concatenated
into a NoSQL API call.<sup class="footnote" id="_footnote_2">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>This challenge is about giving the server the chance to catch a breath
by putting it to sleep for a while, making it essentially a
stripped-down <em>denial-of-service</em> attack challenge.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>In a denial-of-service (DoS) attack, an attacker attempts to prevent
legitimate users from accessing information or services. By targeting
your computer and its network connection, or the computers and network
of the sites you are trying to use, an attacker may be able to prevent
you from accessing email, websites, online accounts (banking, etc.),
or other services that rely on the affected computer.<sup class="footnote" id="_footnote_3">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p>As stated in the
<a href="../introduction/architecture.html" class="xref page">Architecture overview</a>, OWASP Juice
Shop uses a MongoDB derivate as its NoSQL database.</p>
</li>
<li>
<p>The categorization into the <em>NoSQL Injection</em> category totally gives
away the expected attack vector for this challenge. Trying any others
will not solve the challenge, even if they might yield the same
result.</p>
</li>
<li>
<p>In particular, flooding the application with requests will <strong>not</strong>
solve this challenge. <em>That</em> would probably just <em>kill</em> your server
instance.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_all_your_orders_are_belong_to_us"><a class="anchor" href="#_all_your_orders_are_belong_to_us"></a>All your orders are belong to us</h3>
<div class="paragraph">
<p>This challenge is about retrieving all user&#8217;s order data from the NoSQL
DB in a single data extraction using an Injection attack.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This challenge requires a classic Injection attack.</p>
</li>
<li>
<p>Find an API endpoint with the intent of delivering a single order to
the user and work with that.</p>
</li>
<li>
<p>Reading up on how MongoDB queries work is really helpful here.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_update_multiple_product_reviews_at_the_same_time"><a class="anchor" href="#_update_multiple_product_reviews_at_the_same_time"></a>Update multiple product reviews at the same time</h3>
<div class="paragraph">
<p>The UI and API only offer ways to update individual product reviews.
This challenge is about manipulating an update so that it will affect
multiple reviews are the same time.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This challenge requires another classic Injection attack.</p>
</li>
<li>
<p>Take a close look on how the equivalent of UPDATE-statements in
MongoDB work.</p>
</li>
<li>
<p>It is also worth looking into how
<a href="https://docs.mongodb.com/manual/reference/operator/query/">Query Operators</a>
work in MongoDB.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_infect_the_server_with_juicy_malware_by_abusing_arbitrary_command_execution"><a class="anchor" href="#_infect_the_server_with_juicy_malware_by_abusing_arbitrary_command_execution"></a>Infect the server with juicy malware by abusing arbitrary command execution</h3>
<div class="paragraph">
<p>ℹ️ <em>Please note that this challenge is <strong>not available</strong> when running
the Juice Shop in either a Docker container or on a Heroku dyno! It is
not possible to implement this vulnerability in a "safe" way without any
risk of compromise of the underlying system.</em></p>
</div>
<div class="paragraph">
<p>In this challenge you must exploit a Server-side Template Injection
(SSTi) to "infect" the server with a specially crafted "malware".</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can find the juicy malware via a <em>very obvious</em> Google search or
by stumbling into a very ill-placed quarantine folder with the
necessary URLs in it.</p>
</li>
<li>
<p>Making the server download and execute the malware is key to solving
this challenge.</p>
</li>
<li>
<p>For this challenge you do not have to reverse engineer the malware in
any way. That will be required later to solve
<a href="broken-access-control.adoc#request-a-hidden-resource-on-server-through-server">Request a hidden resource on server through server</a>.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Server-side template injection occurs when user input is unsafely
embedded into a server-side template, allowing users to inject
template directives. Using malicious template directives, an attacker
may be able to execute arbitrary code and take full control of the web
server.</p>
</div>
<div class="paragraph">
<p>The severity of this issue varies depending on the type of template
engine being used. Template engines range from being trivial to almost
impossible to exploit. The following steps should be used when
attempting to develop an exploit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Identify the type of template engine being used.</p>
</li>
<li>
<p>Review its documentation for basic syntax, security considerations,
and built-in methods and variables.</p>
</li>
<li>
<p>Explore the template environment and map the attack surface.</p>
</li>
<li>
<p>Audit every exposed object and method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Template injection vulnerabilities can be very serious and can lead to
complete compromise of the application&#8217;s data and functionality, and
often of the server that is hosting the application. It may also be
possible to use the server as a platform for further attacks against
other systems. On the other hand, some template injection
vulnerabilities may pose no significant security risk. <sup class="footnote" id="_footnote_5">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup></p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_retrieve_a_list_of_all_user_credentials_via_sql_injection"><a class="anchor" href="#_retrieve_a_list_of_all_user_credentials_via_sql_injection"></a>Retrieve a list of all user credentials via SQL Injection</h3>
<div class="paragraph">
<p>This challenge explains how a considerable number of companies were
affected by <em>data breaches</em> without anyone breaking into the server room
or sneaking out with a USB stick full of sensitive information. Given
your application is vulnerable to a certain type of SQL Injection
attacks, hackers can have the same effect while comfortably sitting in a
café with free WiFi.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Try to find an endpoint where you can influence data being retrieved
from the server.</p>
</li>
<li>
<p>Craft a <code>UNION SELECT</code> attack string to join data from another table
into the original result.</p>
</li>
<li>
<p>You might have to tackle some query syntax issues step-by-step,
basically hopping from one error to the next</p>
</li>
<li>
<p>As with
<a href="#order-the-christmas-special-offer-of-2014">Order the Christmas special offer of 2014</a>
and
<a href="#exfiltrate-the-entire-db-schema-definition-via-sql-injection">Exfiltrate the entire DB schema definition via SQL Injection</a>
this cannot be achieved through the application frontend.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. <a href="https://owasp.org/www-community/Injection_Flaws" class="bare">https://owasp.org/www-community/Injection_Flaws</a>
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. <a href="https://owasp.org/www-community/attacks/Blind_SQL_Injection" class="bare">https://owasp.org/www-community/attacks/Blind_SQL_Injection</a>
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. <a href="https://wiki.owasp.org/index.php/Testing_for_NoSQL_injection" class="bare">https://wiki.owasp.org/index.php/Testing_for_NoSQL_injection</a>
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. <a href="https://www.us-cert.gov/ncas/tips/ST04-015" class="bare">https://www.us-cert.gov/ncas/tips/ST04-015</a>
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. <a href="https://portswigger.net/kb/issues/00101080_server-side-template-injection" class="bare">https://portswigger.net/kb/issues/00101080_server-side-template-injection</a>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
