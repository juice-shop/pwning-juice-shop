<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Broken Access Control :: Juice Shop Docs</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Juice Shop Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="Juice Shop" data-version="test">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Juice shop Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Preface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/readme.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/motivation.html">Why OWASP Juice Shop exists</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/architecture.html">Architecture overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part I - Hacking preparations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/README.html">Hacking preparations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/running.html">Running OWASP Juice Shop</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/categories.html">Vulnerability categories</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/challenges.html">Challenge tracking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/rules.html">Hacking exercise rules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/happy-path.html">Walking the "happy path"</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/customization.html">Customization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/ctf.html">Hosting a CTF event</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part II - Challenge hunting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="README.html">Challenge hunting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="score-board.html">Finding the Score Board</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="injection.html">Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-authentication.html">Broken Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sensitive-data-exposure.html">Sensitive Data Exposure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xxe.html">XML External Entities (XXE)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="improper-input-validation.html">Improper Input Validation</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="broken-access-control.html">Broken Access Control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security-misconfiguration.html">Security Misconfiguration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xss.html">Cross Site Scripting (XSS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="insecure-deserialization.html">Insecure Deserialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vulnerable-components.html">Vulnerable Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security-through-obscurity.html">Security through Obscurity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="unvalidated-redirects.html">Unvalidated Redirects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-anti-automation.html">Broken Anti-Automation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cryptographic-issues.html">Cryptographic Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="miscellaneous.html">Miscellaneous</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part III - Getting involved</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/README.html">Getting involved</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/feedback.html">Provide feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/contribution.html">Contribute to development</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/codebase.html">Codebase 101</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/translation.html">Help with translation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/tutorials.html">Hacking Instructor tutorial scripts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/donations.html">Donations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Appendix</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/solutions.html">Challenge solutions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/trainers.html">Trainer&#8217;s guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/cheat-detection.html">Cheat detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/code-snippets.html">Coding challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/integration.html">Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/chatbot.html">Chatbot training data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/lyrics.html">Jingle lyrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Postface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/about.html">About this book</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Juice shop Documentation</span>
    <span class="version">test</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Juice shop Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">test</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Juice shop Documentation</a></li>
    <li>Part II - Challenge hunting</li>
    <li><a href="broken-access-control.html">Broken Access Control</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///Users/parthnanda/Desktop/Gsoc/pwning-juice-shop/modules/Root/pages/part2/broken-access-control.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Broken Access Control</h1>
<div id="preamble">
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Most computer systems are designed for use with multiple users.
Privileges mean what a user is permitted to do. Common privileges
include viewing and editing files, or modifying system files.</p>
</div>
<div class="paragraph">
<p>Privilege escalation means a user receives privileges they are not
entitled to. These privileges can be used to delete files, view
private information, or install unwanted programs such as viruses. It
usually occurs when a system has a bug that allows security to be
bypassed or, alternatively, has flawed design assumptions about how it
will be used. Privilege escalation occurs in two forms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Vertical privilege escalation, also known as <em>privilege elevation</em>,
where a lower privilege user or application accesses functions or
content reserved for higher privilege users or applications (e.g.
Internet Banking users can access site administrative functions or
the password for a smartphone can be bypassed.)</p>
</li>
<li>
<p>Horizontal privilege escalation, where a normal user accesses
functions or content reserved for other normal users (e.g. Internet
Banking User A accesses the Internet bank account of User B)<sup class="footnote" id="_footnote_1">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</li>
</ul>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_challenges_covered_in_this_chapter"><a class="anchor" href="#_challenges_covered_in_this_chapter"></a>Challenges covered in this chapter</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Difficulty</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin Section</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access the administration section of the store.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSRF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change the name of a user by performing Cross-Site Request Forgery from another origin.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Easter Egg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Find the hidden easter egg.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Five-Star Feedback</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get rid of all 5-star customer feedback.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forged Feedback</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post some feedback in another user&#8217;s name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forged Review</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post a product review as another user or edit any user&#8217;s existing review.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manipulate Basket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Put an additional product into another user&#8217;s shopping basket.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Product Tampering</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change the <code>href</code> of the link within the OWASP SSL Advanced Forensic Tool (O-Saft) product description into <em><a href="https://owasp.slack.com" class="bare">https://owasp.slack.com</a></em>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSRF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request a hidden resource on server through server.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View Basket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">View another user&#8217;s shopping basket.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_access_the_administration_section_of_the_store"><a class="anchor" href="#_access_the_administration_section_of_the_store"></a>Access the administration section of the store</h3>
<div class="paragraph">
<p>Just like the score board, the admin section was not part of your "happy
path" tour because there seems to be no link to that section either. In
case you were already
<a href="injection.html#_log_in_with_the_administrators_user_account" class="xref page">logged in with the administrator account</a>
you might have noticed that not even for him there is a corresponding
option available in the main menu.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Knowing it exists, you can simply <em>guess</em> what URL the admin section
might have.</p>
</li>
<li>
<p>Alternatively, you can try to find a reference or clue within the
parts of the application that are <em>not usually visible</em> in the browser</p>
</li>
<li>
<p>It is probably just slightly harder to find and gain access to than
the score board link</p>
</li>
<li>
<p>There is some access control in place, but there are at least three
ways to bypass it.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_change_the_name_of_a_user_by_performing_cross_site_request_forgery_from_another_origin"><a class="anchor" href="#_change_the_name_of_a_user_by_performing_cross_site_request_forgery_from_another_origin"></a>Change the name of a user by performing Cross-Site Request Forgery from another origin</h3>
<div class="paragraph">
<p>This challenges requires you to craft the code for the Cross-Site
Request Forgery (CSRF) attack within <a href="http://htmledit.squarefree.com" class="bare">http://htmledit.squarefree.com</a>,
which represents another
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">origin</a>
than the Juice Shop. You can enter your HTML and Script code in the
upper half of the page, while the result is instantly displayed in the
lower half.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Take a look at what happens when you change the username within the
<a href="http://localhost:3000/profile">profile page</a>.</p>
</li>
<li>
<p>Search for information about CSRF attacks and look out for examples
that can be applied to this challenge.</p>
</li>
<li>
<p>Write the code for the CSRF attack within
<a href="http://htmledit.squarefree.com" class="bare">http://htmledit.squarefree.com</a> and verify that it changes your
username.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Please also be aware that the challenge is designed to be solved only with
the specified online HTML editor. This means that Juice Shop will not
recognize the challenge as solved when you are using another origin,
such as for example JSFiddle or CodePen.</em></p>
</div>
<div class="sect3">
<h4 id="_important_information_about_browser_compatibility"><a class="anchor" href="#_important_information_about_browser_compatibility"></a>⚠️ Important information about browser compatibility</h4>
<div class="paragraph">
<p>There is an ongoing initiative, called "Incrementally Better
Cookies", which aims to reduce the impact of CSRF attacks by changing
the default cookie handling of browsers. It is strongly recommended to
understand these changes before attempting this challenge, as otherwise
it might not be solvable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An overview of the planned changes to <code>SameSite</code> can be found in <a href="https://web.dev/samesite-cookie-recipes/" class="bare">https://web.dev/samesite-cookie-recipes/</a>.</p>
</li>
<li>
<p>At the time of this writing, the challenge should work fine with Firefox 96.x or older.</p>
</li>
<li>
<p>If you are in doubt, you can check the behavior of your browser using
the website <a href="https://samesite-sandbox.glitch.me/" class="bare">https://samesite-sandbox.glitch.me/</a> - if you see the text
"set ❌" in the first row below the column "Cross-site?", your browser
uses the old default and should be able to solve the challenge.</p>
</li>
<li>
<p>Although Chrome can be temporarily switched back to the old behavior by starting
it with the option <code>--disable-features=SameSiteByDefaultCookies</code>, the CSRF attack will probably not execute anymore in Chrome 80.x or newer.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_find_the_hidden_easter_egg"><a class="anchor" href="#_find_the_hidden_easter_egg"></a>Find the hidden easter egg</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>An Easter egg is an intentional inside joke, hidden message, or
feature in an interactive work such as a computer program, video game
or DVD menu screen. The name is used to evoke the idea of a
traditional Easter egg hunt.<sup class="footnote" id="_footnote_2">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p>If you solved one of the other four file access challenges, you
already know where the easter egg is located</p>
</li>
<li>
<p>Simply reuse the trick that already worked for the files above</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>When you open the easter egg file, you might be a little disappointed,
as the developers taunt you about not having found <strong>the real</strong> easter
egg! Of course finding <strong>that</strong> is
<a href="cryptographic-issues.html#_apply_some_advanced_cryptanalysis_to_find_the_real_easter_egg" class="xref page">a follow-up challenge</a>
to this one.</em></p>
</div>
</div>
<div class="sect2">
<h3 id="_get_rid_of_all_5_star_customer_feedback"><a class="anchor" href="#_get_rid_of_all_5_star_customer_feedback"></a>Get rid of all 5-star customer feedback</h3>
<div class="paragraph">
<p>If you successfully solved above
<a href="#access-the-administration-section-of-the-store">admin section challenge</a>
deleting the 5-star feedback is very easy.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Nothing happens when you try to delete feedback entries? Check the
JavaScript console for errors!</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_post_some_feedback_in_another_users_name"><a class="anchor" href="#_post_some_feedback_in_another_users_name"></a>Post some feedback in another user&#8217;s name</h3>
<div class="paragraph">
<p>The Juice Shop allows users to provide general feedback including a star
rating and some free text comment. When logged in, the feedback will be
associated with the current user. When not logged in, the feedback will
be posted anonymously. This challenge is about vilifying another user by
posting a (most likely negative) feedback in his or her name!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This challenge can be solved via the user interface or by intercepting
the communication with the RESTful backend.</p>
</li>
<li>
<p>To find the client-side leverage point, closely analyze the HTML form
used for feedback submission.</p>
</li>
<li>
<p>The backend-side leverage point is similar to some of the
<a href="xss.html" class="xref page">XSS challenges</a> found in OWASP Juice Shop.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_post_a_product_review_as_another_user_or_edit_any_users_existing_review"><a class="anchor" href="#_post_a_product_review_as_another_user_or_edit_any_users_existing_review"></a>Post a product review as another user or edit any user&#8217;s existing review</h3>
<div class="paragraph">
<p>The Juice Shop allows users to provide reviews of all the products. A
user has to be logged in before they can post any review for any of the
products. This challenge is about vilifying another user by posting a
(most likely bad) review in his or her name!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This challenge can be solved by using developers tool of your browser
or with tools like postman.</p>
</li>
<li>
<p>Analyze the form used for review submission and try to find a leverage
point.</p>
</li>
<li>
<p>This challenge is pretty similar to
<a href="#post-some-feedback-in-another-users-name">Post some feedback in another user&#8217;s name</a>
challenge.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_put_an_additional_product_into_another_users_shopping_basket"><a class="anchor" href="#_put_an_additional_product_into_another_users_shopping_basket"></a>Put an additional product into another user&#8217;s shopping basket</h3>
<div class="paragraph">
<p><a href="#view-another-users-shopping-basket">View another user&#8217;s shopping basket</a>
was only about spying out other customers. For this challenge you need
to get your hands dirty by putting a product into someone else&#8217;s basket
that cannot be already in there!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check the HTTP traffic while placing products into your own shopping
basket to find a leverage point.</p>
</li>
<li>
<p>Adding more instances of the same product to someone else&#8217;s basket
does not qualify as a solution. The same goes for stealing from
someone else&#8217;s basket.</p>
</li>
<li>
<p>This challenge requires a bit more sophisticated tampering than others
of the same ilk.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_change_the_href_of_the_link_within_the_o_saft_product_description"><a class="anchor" href="#_change_the_href_of_the_link_within_the_o_saft_product_description"></a>Change the href of the link within the O-Saft product description</h3>
<div class="paragraph">
<p>The <em>OWASP SSL Advanced Forensic Tool (O-Saft)</em> product has a link in
its description that leads to that projects wiki page. In this challenge
you are supposed to change that link so that it will send you to
<a href="http://kimminich.de" class="bare">http://kimminich.de</a> instead. It is important to exactly follow the
challenge instruction to make it light up green on the score board:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Original link tag in the description: <code>&lt;a
href="https://wiki.owasp.org/index.php/O-Saft"
target="_blank"&gt;More...&lt;/a&gt;</code></p>
</li>
<li>
<p>Expected link tag in the description: <code>&lt;a href="https://owasp.slack.com"
target="_blank"&gt;More...&lt;/a&gt;</code></p>
</li>
<li>
<p><em>Theoretically</em> there are three possible ways to beat this challenge:</p>
<div class="ulist">
<ul>
<li>
<p>Finding an administrative functionality in the web application that
lets you change product data</p>
</li>
<li>
<p>Looking for possible holes in the RESTful API that would allow you
to update a product</p>
</li>
<li>
<p>Attempting an SQL Injection attack that sneaks in an <code>UPDATE</code>
statement on product data</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>In practice</em> two of these three ways should turn out to be dead ends</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_request_a_hidden_resource_on_server_through_server"><a class="anchor" href="#_request_a_hidden_resource_on_server_through_server"></a>Request a hidden resource on server through server</h3>
<div class="paragraph">
<p>This Server-side Request Forgery challenge will come back to the malware
you used in
<a href="injection.html#_infect_the_server_with_juicy_malware_by_abusing_arbitrary_command_execution" class="xref page">Infect the server with juicy malware by abusing arbitrary command execution</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using whatever you find inside the malware <em>directly</em> will not do you
any good.</p>
</li>
<li>
<p>For this to count as an SSRF attack you need to make the Juice Shop
server <em>attack itself</em>.</p>
</li>
<li>
<p>Do not try to find the source code for the malware on GitHub. Take it
apart with classic reverse-engineering techniques instead.</p>
</li>
</ul>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>In a Server-Side Request Forgery (SSRF) attack, the attacker can abuse
functionality on the server to read or update internal resources. The
attacker can supply or a modify a URL which the code running on the
server will read or submit data to, and by carefully selecting the
URLs, the attacker may be able to read server configuration such as
AWS metadata, connect to internal services like http enabled databases
or perform post requests towards internal services which are not
intended to be exposed. <sup class="footnote" id="_footnote_3">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="_view_another_users_shopping_basket"><a class="anchor" href="#_view_another_users_shopping_basket"></a>View another user&#8217;s shopping basket</h3>
<div class="paragraph">
<p>This horizontal privilege escalation challenge demands you to access the
shopping basket of another user. Being able to do so would give an
attacker the opportunity to spy on the victims shopping behaviour. He
could also play a prank on the victim by manipulating the items or their
quantity, hoping this will go unnoticed during checkout. This could lead
to some arguments between the victim and the vendor.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Try out all existing functionality involving the shopping basket while
having an eye on the HTTP traffic.</p>
</li>
<li>
<p>There might be a client-side association of user to basket that you
can try to manipulate.</p>
</li>
<li>
<p>In case you manage to update the database via SQL Injection so that a
user is linked to another shopping basket, the application will <em>not</em>
notice this challenge as solved.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. <a href="https://en.wikipedia.org/wiki/Privilege_escalation" class="bare">https://en.wikipedia.org/wiki/Privilege_escalation</a>
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. <a href="https://en.wikipedia.org/wiki/Easter_egg_(media" class="bare">https://en.wikipedia.org/wiki/Easter_egg_(media</a>)
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. <a href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery" class="bare">https://owasp.org/www-community/attacks/Server_Side_Request_Forgery</a>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
