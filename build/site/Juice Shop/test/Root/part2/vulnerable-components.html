<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vulnerable Components :: Juice Shop Docs</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Juice Shop Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="Juice Shop" data-version="test">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Juice shop Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Preface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/readme.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/motivation.html">Why OWASP Juice Shop exists</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/architecture.html">Architecture overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part I - Hacking preparations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/README.html">Hacking preparations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/running.html">Running OWASP Juice Shop</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/categories.html">Vulnerability categories</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/challenges.html">Challenge tracking</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/rules.html">Hacking exercise rules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/happy-path.html">Walking the "happy path"</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/customization.html">Customization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part1/ctf.html">Hosting a CTF event</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part II - Challenge hunting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="README.html">Challenge hunting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="score-board.html">Finding the Score Board</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="injection.html">Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-authentication.html">Broken Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sensitive-data-exposure.html">Sensitive Data Exposure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xxe.html">XML External Entities (XXE)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="improper-input-validation.html">Improper Input Validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-access-control.html">Broken Access Control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security-misconfiguration.html">Security Misconfiguration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xss.html">Cross Site Scripting (XSS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="insecure-deserialization.html">Insecure Deserialization</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="vulnerable-components.html">Vulnerable Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="security-through-obscurity.html">Security through Obscurity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="unvalidated-redirects.html">Unvalidated Redirects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="broken-anti-automation.html">Broken Anti-Automation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cryptographic-issues.html">Cryptographic Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="miscellaneous.html">Miscellaneous</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Part III - Getting involved</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/README.html">Getting involved</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/feedback.html">Provide feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/contribution.html">Contribute to development</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/codebase.html">Codebase 101</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/translation.html">Help with translation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/tutorials.html">Hacking Instructor tutorial scripts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../part3/donations.html">Donations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Appendix</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/solutions.html">Challenge solutions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/trainers.html">Trainer&#8217;s guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/cheat-detection.html">Cheat detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/code-snippets.html">Coding challenges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/integration.html">Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/monitoring.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/chatbot.html">Chatbot training data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/lyrics.html">Jingle lyrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Postface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/about.html">About this book</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Juice shop Documentation</span>
    <span class="version">test</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">Juice shop Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">test</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Juice shop Documentation</a></li>
    <li>Part II - Challenge hunting</li>
    <li><a href="vulnerable-components.html">Vulnerable Components</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///Users/parthnanda/Desktop/Gsoc/pwning-juice-shop/modules/Root/pages/part2/vulnerable-components.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Vulnerable Components</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The challenges in this chapter are all about security issues of
libraries or other 3rd party components the application uses internally.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_challenges_covered_in_this_chapter"><a class="anchor" href="#_challenges_covered_in_this_chapter"></a>Challenges covered in this chapter</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Difficulty</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arbitrary File Write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Overwrite the Legal Information file.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forged Signed JWT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forge an almost properly RSA-signed JWT token that impersonates the (non-existing) user <em>rsa_lord@juice-sh.op</em>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frontend Typosquatting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inform the shop about a typosquatting imposter that dug itself deep into the frontend. (Mention the exact name of the culprit)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kill Chatbot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permanently disable the support chatbot so that it can no longer answer customer queries.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Legacy Typosquatting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inform the shop about a typosquatting trick it has been a victim of at least in <code>v6.2.0-SNAPSHOT</code>. (Mention the exact name of the culprit)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local File Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gain read access to an arbitrary local file on the web server.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supply Chain Attack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inform the development team about a danger to some of <em>their</em> credentials. (Send them the URL of the <em>original report</em> or an assigned CVE or another identifier of this vulnerability)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unsigned JWT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forge an essentially unsigned JWT token that impersonates the (non-existing) user <em>jwtn3d@juice-sh.op</em>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐⭐</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vulnerable Library</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inform the shop about a vulnerable library it is using. (Mention the exact library name and version in your comment)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">⭐⭐⭐⭐</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="overwrite-the-legal-information-file"><a class="anchor" href="#overwrite-the-legal-information-file"></a>Overwrite the Legal Information file</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Uploaded files represent a significant risk to applications. The first
step in many attacks is to get some code to the system to be attacked.
Then the attack only needs to find a way to get the code executed.
Using a file upload helps the attacker accomplish the first step.</p>
</div>
<div class="paragraph">
<p>The consequences of unrestricted file upload can vary, including
complete system takeover, an overloaded file system or database,
forwarding attacks to back-end systems, client-side attacks, or simple
defacement. It depends on what the application does with the uploaded
file and especially where it is stored.</p>
</div>
<div class="paragraph">
<p>There are really two classes of problems here. The first is with the
file metadata, like the path and file name. These are generally
provided by the transport, such as HTTP multi-part encoding. This data
may trick the application into overwriting a critical file or storing
the file in a bad location. You must validate the metadata extremely
carefully before using it.</p>
</div>
<div class="paragraph">
<p>The other class of problem is with the file size or content. The range
of problems here depends entirely on what the file is used for. See
the examples below for some ideas about how files might be misused. To
protect against this type of attack, you should analyse everything
your application does with files and think carefully about what
processing and interpreters are involved.<sup class="footnote" id="_footnote_3">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p>Find all places in the application where file uploads are possible.</p>
</li>
<li>
<p>For at least one of these, the Juice Shop is depending on a library
that suffers from an arbitrary file overwrite vulnerability.</p>
</li>
<li>
<p>You can find a hint toward the underlying vulnerability in the
<a href="https://twitter.com/owasp_juiceshop">@owasp_juiceshop</a> Twitter
timeline</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_forge_an_almost_properly_rsa_signed_jwt_token"><a class="anchor" href="#_forge_an_almost_properly_rsa_signed_jwt_token"></a>Forge an almost properly RSA-signed JWT token</h3>
<div class="paragraph">
<p>Like
<a href="#forge-an-essentially-unsigned-jwt-token">Forge an essentially unsigned JWT token</a>
this challenge requires you to make a valid JWT for a user that does not
exist. What makes this challenge even harder is the requirement to have
the JWT look like it was properly signed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The three generic hints from
<a href="#forge-an-essentially-unsigned-jwt-token">Forge an essentially unsigned JWT token</a>
also help with this challenge.</p>
</li>
<li>
<p>Instead of enforcing no encryption to be applied, try to apply a more
sophisticated exploit against the JWT libraries used in the Juice
Shop.</p>
</li>
<li>
<p>Getting your hands on the public RSA key the application employs for
its JWTs is mandatory for this challenge.</p>
</li>
<li>
<p>Finding the corresponding private key should actually be impossible,
but that obviously doesn&#8217;t make this challenge unsolvable.</p>
</li>
<li>
<p>Make sure your JWT is URL safe!</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_inform_the_shop_about_a_typosquatting_imposter_that_dug_itself_deep_into_the_frontend"><a class="anchor" href="#_inform_the_shop_about_a_typosquatting_imposter_that_dug_itself_deep_into_the_frontend"></a>Inform the shop about a typosquatting imposter that dug itself deep into the frontend</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Typosquatting, also called URL hijacking, a sting site, or a fake URL,
is a form of cybersquatting, and possibly brandjacking which relies on
mistakes such as typos made by Internet users when inputting a website
address into a web browser. Should a user accidentally enter an
incorrect website address, they may be led to any URL (including an
alternative website owned by a cybersquatter).</p>
</div>
<div class="paragraph">
<p>The typosquatter&#8217;s URL will usually be one of four kinds, all similar
to the victim site address (e.g. example.com):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A common misspelling, or foreign language spelling, of the intended
site: exemple.com</p>
</li>
<li>
<p>A misspelling based on typos: examlpe.com</p>
</li>
<li>
<p>A differently phrased domain name: examples.com</p>
</li>
<li>
<p>A different top-level domain: example.org</p>
</li>
<li>
<p>An abuse of the Country Code Top-Level Domain (ccTLD): example.cm by
using .cm, example.co by using .co, or example.om by using .om. A
person leaving out a letter in .com in error could arrive at the
fake URL&#8217;s website.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once in the typosquatter&#8217;s site, the user may also be tricked into
thinking that they are in fact in the real site, through the use of
copied or similar logos, website layouts or content. Spam emails
sometimes make use of typosquatting URLs to trick users into visiting
malicious sites that look like a given bank&#8217;s site, for instance.<sup class="footnote" id="_footnote_1">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>This challenge is about identifying and reporting (via the
<a href="http://localhost:3000/#/contact" class="bare">http://localhost:3000/#/contact</a> form) a case of typosquatting hidden in
the Juice Shop. It is supposedly hard to locate.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This challenge has nothing to do with URLs or domains.</p>
</li>
<li>
<p>Other than for
<a href="#inform-the-shop-about-a-typosquatting-trick-it-has-been-a-victim-of">its legacy companion</a>,
combing through the <code>package.json.bak</code> does not help for this
challenge.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ℹ️ There is no actual malice or mischief included, as the typosquatter
is completely harmless. Just keep in mind that in reality, a case like
this could come with negative consequences and would sometimes be even
harder to identify.</p>
</div>
</div>
<div class="sect2">
<h3 id="_permanently_disable_the_support_chatbot"><a class="anchor" href="#_permanently_disable_the_support_chatbot"></a>Permanently disable the support chatbot</h3>
<div class="paragraph">
<p>Juice shop&#8217;s handy dandy chatbot is cute and all, but can it defend
itself against malicious attackers looking to rob the customers of its
services?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In order to disable the chatbot for all users, you must first get an
understanding of how it works under the hood</p>
</li>
<li>
<p>The chatbot sure offers a lot of functionality. Could it be that
juice-shop relies on a third party, possibly open source library for
this?</p>
</li>
<li>
<p>Maybe you can try to gather clues from around juice shop and then go
dumpster dive the internet to get a hold of the bot&#8217;s source</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_inform_the_shop_about_a_typosquatting_trick_it_has_been_a_victim_of"><a class="anchor" href="#_inform_the_shop_about_a_typosquatting_trick_it_has_been_a_victim_of"></a>Inform the shop about a typosquatting trick it has been a victim of</h3>
<div class="paragraph">
<p>This challenge is about identifying and reporting (via the
<a href="http://localhost:3000/#/contact" class="bare">http://localhost:3000/#/contact</a> form) a case of typosquatting that
successfully sneaked into an older version of the Juice Shop. Luckily,
it is not in use any more in v14.5.0.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Just like
<a href="#inform-the-shop-about-a-typosquatting-imposter-that-dug-itself-deep-into-the-frontend">its frontend companion</a>
this challenge also has nothing to do with URLs or domains.</p>
</li>
<li>
<p>Investigating the
<a href="sensitive-data-exposure.html#_access_a_developers_forgotten_backup_file" class="xref page">forgotten developer&#8217;s backup file</a>
might bring some insight.</p>
</li>
<li>
<p><a href="https://iamakulov.com/notes/npm-malicious-packages/">Malicious packages in npm</a>
is a worthwhile read on <a href="https://iamakulov.com">Ivan Akulov&#8217;s blog</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_gain_read_access_to_an_arbitrary_local_file_on_the_web_server"><a class="anchor" href="#_gain_read_access_to_an_arbitrary_local_file_on_the_web_server"></a>Gain read access to an arbitrary local file on the web server</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A <strong>file inclusion vulnerability</strong> is a type of web vulnerability that is most commonly found to affect web applications that rely on a scripting run time. This issue is caused when an application builds a path to executable code using an attacker-controlled variable in a way that allows the attacker to control which file is executed at run time. A file include vulnerability is distinct from a generic directory traversal attack, in that directory traversal is a way of gaining unauthorized file system access, and a file inclusion vulnerability subverts how an application loads code for execution. Successful exploitation of a file inclusion vulnerability will result in remote code execution on the web server that runs the affected web application. An attacker can use remote code execution to create a web shell on the web server, which can be used for website defacement.</p>
</div>
<div class="paragraph">
<p><strong>Remote file inclusion (RFI)</strong> occurs when the web application downloads and executes a remote file. These remote files are usually obtained in the form of an HTTP or FTP URI as a user-supplied parameter to the web application.</p>
</div>
<div class="paragraph">
<p><strong>Local file inclusion (LFI)</strong> is similar to a remote file inclusion vulnerability except instead of including remote files, only local files i.e. files on the current server can be included for execution. This issue can still lead to remote code execution by including a file that contains attacker-controlled data such as the web server&#8217;s access logs.<sup class="footnote" id="_footnote_5">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="ulist">
<ul>
<li>
<p>You should read up on Local File Read (LFR) vulnerabilities in popular NodeJS template engines</p>
</li>
<li>
<p>Look for an easily forgettable endpoint in Juice Shop to test out the LFR attack</p>
</li>
<li>
<p><code>500 Internal Server Error</code> is always an interesting status code</p>
</li>
<li>
<p>Fuzzing can also help with this challenge</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_inform_the_development_team_about_a_danger_to_some_of_their_credentials"><a class="anchor" href="#_inform_the_development_team_about_a_danger_to_some_of_their_credentials"></a>Inform the development team about a danger to some of their credentials</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A software supply chain attack is when an attacker gains access to a
legitimate software vendor and then compromises either the software or
update repository. This is done with the intention of installing a
backdoor, or other malicious code, into the legitimate software update
provided by the vendor. As users update their software, unwittingly
falling victim to the Trojanized update, they also install the
embedded malicious code.<sup class="footnote" id="_footnote_4">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>ℹ️ Please note that having the OWASP Juice Shop installed on your
computer <em>does not</em> put you at any actual risk! This challenge does
<em>neither</em> install a backdoor or Trojan nor does it bring any other
harmful code to your system!</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The shop&#8217;s end users are not the targets here. The developers of the
shop are!</p>
</li>
<li>
<p>This is a research-heavy challenge which does not involve any actual
hacking.</p>
</li>
<li>
<p>Solving
<a href="sensitive-data-exposure.html#_access_a_developers_forgotten_backup_file" class="xref page">Access a developer&#8217;s forgotten backup file</a>
before attempting this challenge will save you from a lot of
frustration.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_forge_an_essentially_unsigned_jwt_token"><a class="anchor" href="#_forge_an_essentially_unsigned_jwt_token"></a>Forge an essentially unsigned JWT token</h3>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>JSON Web Token (JWT) is a compact, URL-safe means of representing
claims to be transferred between two parties. The claims in a JWT are
encoded as a JSON object that is used as the payload of a JSON Web
Signature (JWS) structure or as the plaintext of a JSON Web Encryption
(JWE) structure, enabling the claims to be digitally signed or
integrity protected with a Message Authentication Code (MAC) and/or
encrypted.<sup class="footnote" id="_footnote_2">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup></p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>This challenge involves forging a valid JWT for a user that does not
exist in the database but make the application believe it is still
legit.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You should begin with retrieving a valid JWT from the application&#8217;s
<code>Authorization</code> request header.</p>
</li>
<li>
<p>A JWT is only given to users who have logged in. They have a limited
validity, so better do not dawdle.</p>
</li>
<li>
<p>Try to convince the site to give you a <em>valid</em> token with the required
payload while downgrading to <em>no</em> encryption at all.</p>
</li>
<li>
<p>Make sure your JWT is URL safe!</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_inform_the_shop_about_a_vulnerable_library_it_is_using"><a class="anchor" href="#_inform_the_shop_about_a_vulnerable_library_it_is_using"></a>Inform the shop about a vulnerable library it is using</h3>
<div class="paragraph">
<p>This challenge is quite similar to
<a href="cryptographic-issues.html#<em>inform_the_shop_about_an_algorithm_or_library_it_should_definitely_not_use_the_way_it_does" class="xref page">Inform the shop about an algorithm or library it should definitely not use the way it does</a>
with the difference, that here not the _general use</em> of the library is
the issue. The application is just using <em>a version</em> of a library that
contains known vulnerabilities.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the <em>Contact Us</em> form to submit a feedback mentioning the
vulnerable library including its exact version.</p>
</li>
<li>
<p>Look for possible dependencies related to security in the
<code>package.json.bak</code> you probably harvested earlier during the
<a href="sensitive-data-exposure.html#_access_a_developers_forgotten_backup_file" class="xref page">Access a developer&#8217;s forgotten backup file</a>
challenge.</p>
</li>
<li>
<p>Do some research on the internet for known security issues in the most
suspicious application dependencies.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. <a href="https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload" class="bare">https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload</a>
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. <a href="https://en.wikipedia.org/wiki/Typosquatting" class="bare">https://en.wikipedia.org/wiki/Typosquatting</a>
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. <a href="https://en.wikipedia.org/wiki/File_inclusion_vulnerability" class="bare">https://en.wikipedia.org/wiki/File_inclusion_vulnerability</a>
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. <a href="https://www.rsa.com/en-us/blog/2017-02/are-software-supply-chain-attacks-the-new-norm" class="bare">https://www.rsa.com/en-us/blog/2017-02/are-software-supply-chain-attacks-the-new-norm</a>
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. <a href="https://tools.ietf.org/html/rfc7519" class="bare">https://tools.ietf.org/html/rfc7519</a>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
